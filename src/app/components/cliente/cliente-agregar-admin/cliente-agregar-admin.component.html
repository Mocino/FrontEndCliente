<form [formGroup]="formCliente" (ngSubmit)="addEditCliente()" class="form-container">
  <!-- Clientes -->
  <div class="section">
    <h3>Clientes:</h3>
    <div class="fields">
      <div>
        <mat-form-field>
          <mat-label>Nombres</mat-label>
          <input matInput formControlName="nombres" type="text" />
          <mat-error *ngIf="formCliente.get('nombres')?.hasError('required')">Nombres requeridos</mat-error>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Apellidos</mat-label>
          <input matInput formControlName="apellidos" type="text" />
          <mat-error *ngIf="formCliente.get('apellidos')?.hasError('required')">Apellidos requeridos</mat-error>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Dirección</mat-label>
          <input matInput formControlName="direccion" type="text" />
          <mat-error *ngIf="formCliente.get('direccion')?.hasError('required')">Direccion requerido</mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field appearance="outline">
          <mat-label>Fecha de Nacimiento</mat-label>
          <input matInput [matDatepicker]="picker" placeholder="Fecha de Nacimiento" formControlName="fechaNacimiento" autocomplete="off">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="formCliente.get('fechaNacimiento')?.hasError('required')">Fecha requerida</mat-error>
          <mat-error *ngIf="formCliente.get('fechaNacimiento')?.hasError('menorDeEdad')">Debe ser mayor de 18 años</mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field>
          <mat-label>DPI</mat-label>
          <input matInput formControlName="dpi" type="text" />
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>NIT</mat-label>
          <input matInput formControlName="nit" type="text" />
          <mat-error *ngIf="formCliente.get('nit')?.hasError('required')">
            El NIT es requerido
          </mat-error>
          <mat-error *ngIf="formCliente.get('nit')?.hasError('pattern')">
            Ingrese un Nit Valido
          </mat-error>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Empresa</mat-label>
          <input matInput formControlName="empresa" type="text" />
          <mat-error *ngIf="formCliente.get('empresa')?.hasError('required')">Empresa requerida</mat-error>
        </mat-form-field>
      </div>
    </div>
  </div>

  <!-- Contactos -->
  <div class="section">
    <h3>Contacto:</h3>
    <div class="fields" formArrayName="contactos">
      <div *ngFor="let contacto of contactos.controls; let i=index" [formGroupName]="i" class="contact-group">
        <div>
          <mat-form-field>
            <mat-label>Tipo de Contacto</mat-label>
            <mat-select formControlName="tipoContacto" placeholder="Seleccione el tipo de contacto">
              <mat-option *ngFor="let tipo of tiposContacto" [value]="tipo.valor">
                {{ tipo.nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <mat-label>Valor de Contacto</mat-label>
            <input matInput formControlName="valorContacto" type="text" />
          </mat-form-field>
        </div>
        <button mat-raised-button color="warn" (click)="removeContacto(i)">Eliminar</button>
      </div>
    </div>
    <button mat-raised-button color="primary" (click)="addContacto()">Añadir Contacto</button>
  </div>


  <!-- Métodos de Pago -->
  <div class="section">
    <h3>Métodos de Pago:</h3>
    <div class="fields" formArrayName="metodosDePago">
      <div *ngFor="let metodo of metodosDePago.controls; let i=index" [formGroupName]="i" class="metodo-group">
        <div>
          <mat-form-field>
            <mat-label>Metodo de Pago</mat-label>
            <mat-select formControlName="tipo" placeholder="Seleccione el tipo de contacto">
              <mat-option *ngFor="let tipo of tiposMetodo" [value]="tipo.valor">
                {{ tipo.nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <mat-label>Fecha de Vencimiento</mat-label>
            <input matInput formControlName="fechaVencimiento" type="date" />
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <mat-label>Número</mat-label>
            <input matInput formControlName="numero" type="text" />
          </mat-form-field>
        </div>
        <div>
          <mat-form-field>
            <mat-label>Nombre del Titular</mat-label>
            <input matInput formControlName="nombreTitular" type="text" />
          </mat-form-field>
        </div>
        <button mat-raised-button color="warn" (click)="removeMetodosPago(i)">Eliminar</button>
      </div>
    </div>
    <button mat-raised-button color="primary" (click)="addMetodosPago()">Añadir Método de Pago</button>
  </div>


  <button mat-raised-button color="primary" type="submit">Guardar</button>

  <button mat-raised-button mat-dialog-close color="warn">Volver</button>
</form>
